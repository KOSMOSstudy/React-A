# 5ì£¼ì°¨ React ìŠ¤í„°ë”” ì •ë¦¬

## ê°œì¸ì´ ë§Œë“  í…œí”Œë¦¿ì…ë‹ˆë‹¤! í…œí”Œë¦¿ì´ ì˜¬ë¼ì˜¤ë©´ ìˆ˜ì • ì˜ˆì •

| ì¥   | ì œëª©                         |
| ---- | ---------------------------- |
| 14ì¥ | ë¦¬ì•¡íŠ¸ ë¼ìš°í„°ë¡œ SPA ê°œë°œí•˜ê¸° |
| 15ì¥ | Recoil ì—°ìŠµ                  |

## 14ì¥

### 14.5 ë°ì´í„° ì—°ë™í•˜ê¸°

ğŸ“NewsList ì»´í¬ë„ŒíŠ¸ì—ì„œ ì´ì „ì— ì‚¬ìš©í–ˆë˜ APIë¥¼ í˜¸ì¶œí•´ë³´ì

- ì´ë•Œ useEffectë¥¼ ì‚¬ìš©í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë Œë”ë§ ë˜ëŠ” ì‹œì ì— APIë¥¼ ìš”ì²­
- useEffectì— ë“±ë¡í•˜ëŠ” í•¨ìˆ˜ì— asyncë¥¼ ë¶™ì´ë©´ ì•ˆë¨
- useEffectì—ì„œ ë°˜í™˜í•´ì•¼ í•˜ëŠ” ê°’ì€ ë’·ì •ë¦¬ í•¨ìˆ˜ì´ê¸° ë•Œë¬¸
- ë”°ë¼ì„œ useEffect ë‚´ë¶€ì—ì„œ async/awaitë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´, í•¨ìˆ˜ ë‚´ë¶€ì— async í‚¤ì›Œë“œê°€ ë¶™ì€ ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•´ ì£¼ì–´ì•¼ í•¨
- ìš”ì²­ì´ ëŒ€ê¸° ì¤‘ì¼ ë•ŒëŠ” loading ê°’ì´ trueê°€ ë˜ê³ , ìš”ì²­ì´ ëë‚˜ë©´ Loading ê°’ì´ falseê°€ ë˜ì–´ì•¼ í•¨

```javascript:components/NewsList.js
import React, {useState, useEffect} from 'react';
import styled from 'styled-components';
import NewsItem from './NewsItem';
import axios from 'axios';

const NewsListBlock = styled.div`
    box-sizing: border-box;
    padding-bottom: 3rem;
    width: 768px;
    margin: 0 auto;
    margin-top: 2rem;
    @media screen and (max-with: 768px){
        width: 100%;
        padding-left: 1rem;
        padding-right: 1rem;

    }
    `;


    const NewsList=()=>{
        const [articles, setArticles] = useState(null);
        const [loading, setLoading] = useState(false);

        useEffect(()=> {
            //asyncë¥¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ ë”°ë¡œ ì„ ì–¸
            const fetchData = async () => {
                setLoading(true);
                try{
                    const response = await axios.get(
                        'https://newsapi.org/v2/top-headlines?country=kr&apiKey=c33d47e154f7420dba0b22bc0f01c941'
                    );
                    setArticles(response.data.articles);
                }catch(e){
                    console.log(e);
                }
                setLoading(false);
            };
            fetchData();
        },[]);

        if(loading){
            return <NewsListBlock>ëŒ€ê¸° ì¤‘.....</NewsListBlock>
        }
        if(!articles){
            return null;
        }
        return(
            <NewsListBlock>
                {articles.map(article =>(
                    <NewsItem key={article.url} article={article}/>
                ))}
            </NewsListBlock>
        );
    };

    export default NewsList;
```

<img src='./img/NewsList.png' width='700px' />

- map í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ì „ì— ê¼­ !articlesë¥¼ ì¡°íšŒí•˜ì—¬ í•´ë‹¹ ê°’ì´ í˜„ì¬ nullì´ ì•„ë‹Œì§€ ê²€ì‚¬í•´ì•¼í•¨.
- ì´ ì‘ì—…ì„ í•˜ì§€ ì•Šìœ¼ë©´, ì•„ì§ ë°ì´í„°ê°€ ì—†ì„ ë•Œ nullì—ëŠ” mapí•¨ìˆ˜ê°€ ì—†ê¸° ë•Œë¬¸ì— ë Œë”ë§ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒ

### 14.6 ì¹´í…Œê³ ë¦¬ ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°

â—ë‰´ìŠ¤ì˜ ì¹´í…Œê³ ë¦¬ ì„ íƒê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ì

ğŸ“ ì¹´í…Œê³ ë¦¬ ì„ íƒ UI ë§Œë“¤ê¸°

```javascript: components/Categories.js
import React from 'react';
import styled from 'styled-components';

const categories = [
    {
        name: 'all',
        text: 'ì „ì²´ë³´ê¸°'

    },
    {
        name: 'business',
        text: 'ë¹„ì¦ˆë‹ˆìŠ¤'
    },
    {
        name: 'entertainment',
        text: 'ì—”í„°í…Œì¸ë¨¼íŠ¸'
    },
    {
        name: 'health',
        text: 'ê±´ê°•'
    },
    {
        name: 'science',
        text: 'ê³¼í•™'
    },
    {
        name: 'sports',
        text: 'ìŠ¤í¬ì¸ '
    },
    {
        name: 'technology',
        text: 'ê¸°ìˆ '
    }
];

const CategoriesBlock = styled.div`
    display: flex;
    padding: 1rem;
    width: 768px;
    margin: 0 auto;
    @media screen and (max-width: 768px){
        width: 100%;
        overflow-x: auto;
    }
`;

const Category = styled.div`
    font-size: 1.125rem;
    cursor: pointer;
    white-space: pre;
    text-decoration: none;
    color: inherit;
    padding-bottom: 0.25rem;

    &:hover{
        color: #495057;
    }

    & + & {
        margin-left: 1rem;
    }
    `;

    const Categories = () => {
        return (
            <CategoriesBlock>
                {categories.map(c=>(
                    <Category key={c.name}>{c.text}</Category>
                ))}
            </CategoriesBlock>
        );
    };

export default Categories;
```

-ìœ„ ì½”ë“œì—ì„œëŠ” catagories ë¼ëŠ” ë°°ì—´ ì•ˆì— nameê³¼ textê°’ì´ ë“¤ì–´ê°€ ìˆëŠ” ê°ì²´ë“¤ì„ ë„£ì–´ ì£¼ì–´ì„œ í•œê¸€ë¡œ ëœ ì¹´ë°ê³ ë¦¬ì™€ ì‹¤ì œ ì¹´ë°ê³ ë¦¬ ê°’ì„ ì—°ê²°ì‹œì¼œ ì¤Œ

- nameì€ ì‹¤ì œ ì¹´ë°ê³ ë¦¬ ê°’, textê°’ì€ ë Œë”ë§í•  ë•Œ ì‚¬ìš©í•  í•œê¸€ ì¹´ë°ê³ ë¦¬ë¥¼ ê°€ë¦¬í‚´

<img src='./img/category.png' width='700px' />

â—ì´ì œ Appì—ì„œ category ìƒíƒœë¥¼ useStateë¡œ ê´€ë¦¬í•´ë³´ì

- ì¶”ê°€ë¡œ category ê°’ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” onSelectë¼ëŠ” í•¨ìˆ˜ë„ ë§Œë“¤ì–´ì£¼ì
- ê·¸ë¦¬ê³  categoryì™€ onSelect í•¨ìˆ˜ë¥¼ Categories ì»´í¬ë„ŒíŠ¸ì—ê²Œ propsë¡œ ì „ë‹¬í•˜ê¸°
- Category ê°’ì„ NewsList ì»´í¬ë„ŒíŠ¸ì—ê²Œë„ ì „ë‹¬í•´ì£¼ì–´ì•¼ í•¨

```javascript:components/Categories.js
import React from 'react';
import styled, {css} from 'styled-components';

const categories = [
    {
        name: 'all',
        text: 'ì „ì²´ë³´ê¸°'

    },
    {
        name: 'business',
        text: 'ë¹„ì¦ˆë‹ˆìŠ¤'
    },
    {
        name: 'entertainment',
        text: 'ì—”í„°í…Œì¸ë¨¼íŠ¸'
    },
    {
        name: 'health',
        text: 'ê±´ê°•'
    },
    {
        name: 'science',
        text: 'ê³¼í•™'
    },
    {
        name: 'sports',
        text: 'ìŠ¤í¬ì¸ '
    },
    {
        name: 'technology',
        text: 'ê¸°ìˆ '
    }
];

const CategoriesBlock = styled.div`
    display: flex;
    padding: 1rem;
    width: 768px;
    margin: 0 auto;
    @media screen and (max-width: 768px){
        width: 100%;
        overflow-x: auto;
    }
`;

const Category = styled.div`
    font-size: 1.125rem;
    cursor: pointer;
    white-space: pre;
    text-decoration: none;
    color: inherit;
    padding-bottom: 0.25rem;

    &:hover{
        color: #495057;
    }

    ${props=>
    props.active && css`
    font-weight: 600;
    border-bottom: 2px solid #22b8cf;
    color: #22b8cf;
    &:hover{
        color: #3bc9db;
    }
`}

    & + & {
        margin-left: 1rem;
    }
    `;

    const Categories = ({onSelect, category}) => {
        return (
            <CategoriesBlock>
                {categories.map(c=>(
                    <Category
                    key={c.name}
                    active={category === c.name}
                    onClick={()=> onSelect(c.name)}
                    >
                    {c.text}
                    </Category>
                ))}
            </CategoriesBlock>
        );
    };

export default Categories;
```

ğŸ“API í˜¸ì¶œí•  ë•Œ ì¹´í…Œê³ ë¦¬ ì§€ì •í•˜ê¸°

```javascript: components/NewsList.js
import React, {useState, useEffect} from 'react';
import styled from 'styled-components';
import NewsItem from './NewsItem';
import axios from 'axios';

const NewsListBlock = styled.div`
    box-sizing: border-box;
    padding-bottom: 3rem;
    width: 768px;
    margin: 0 auto;
    margin-top: 2rem;
    @media screen and (max-with: 768px){
        width: 100%;
        padding-left: 1rem;
        padding-right: 1rem;

    }
    `;


    const NewsList=({category})=>{
        const [articles, setArticles] = useState(null);
        const [loading, setLoading] = useState(false);

        useEffect(()=> {
            //asyncë¥¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ ë”°ë¡œ ì„ ì–¸
            const fetchData = async () => {
                setLoading(true);
                try{
                    const query = category === 'all'? '':`&category=${category}`;
                    const response = await axios.get(
                        'https://newsapi.org/v2/top-headlines?country=kr${query}&apiKey=c33d47e154f7420dba0b22bc0f01c941'
                    );
                    setArticles(response.data.articles);
                }catch(e){
                    console.log(e);
                }
                setLoading(false);
            };
            fetchData();
        },[category]);

        if(loading){
            return <NewsListBlock>ëŒ€ê¸° ì¤‘.....</NewsListBlock>
        }
        if(!articles){
            return null;
        }
        return(
            <NewsListBlock>
                {articles.map(article =>(
                    <NewsItem key={article.url} article={article}/>
                ))}
            </NewsListBlock>
        );
    };

    export default NewsList;
```

-> ì˜¤ë¥˜ ë°œìƒ

### 14.7 ë¦¬ì•¡íŠ¸ ë¼ìš°í„° ì ìš©í•˜ê¸°

1. ë¦¬ì•¡íŠ¸ ë¼ìš°í„° ì„¤ì¹˜

2. Newspage ìƒì„±

```javascript:pages/NewsPage.js
import React from 'react';
import Categories from '../components/Categories';
import NewsList from '../components/NewsList';

const NewsPage = ({match}) => {
    const category = match.params.category || 'all';

    return(
        <>
        <Categories />
        <NewsList category={category}/>
        </>
    );
};

export default NewsPage;
```

- í˜„ì¬ ì„ íƒëœ category ê°’ì„ url íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ
  cateogires ì»´í¬ë„ŒíŠ¸ì—ì„œ í˜„ì¬ ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ê°’ì„ ì•Œë ¤ì¤„ í•„ìš” X, onSelectí•¨ìˆ˜ë¥¼ ë”°ë¡œ ì „ë‹¬í•´ì¤„ í•„ìš” X

```javascript:app.js
const App = () => {
  return <Route path="/:category?" component={NewsPage}/>;
};
```

- /:category? ëŠ” category ê°’ì´ ì„ íƒì ì´ë¼ëŠ” ê²ƒì„ ì˜ë¯¸
- ìˆì„ ìˆ˜ë„ ìˆê³  ì—†ì„ ìˆ˜ë„ ìˆë‹¤ëŠ” ëœ»!

```javascript: components/Categories.js
import React from 'react';
import styled, {css} from 'styled-components';
import {NavLink} from 'react-router-dom';

const categories = [
    {
        name: 'all',
        text: 'ì „ì²´ë³´ê¸°'

    },
    {
        name: 'business',
        text: 'ë¹„ì¦ˆë‹ˆìŠ¤'
    },
    {
        name: 'entertainment',
        text: 'ì—”í„°í…Œì¸ë¨¼íŠ¸'
    },
    {
        name: 'health',
        text: 'ê±´ê°•'
    },
    {
        name: 'science',
        text: 'ê³¼í•™'
    },
    {
        name: 'sports',
        text: 'ìŠ¤í¬ì¸ '
    },
    {
        name: 'technology',
        text: 'ê¸°ìˆ '
    }
];

const CategoriesBlock = styled.div`
    display: flex;
    padding: 1rem;
    width: 768px;
    margin: 0 auto;
    @media screen and (max-width: 768px){
        width: 100%;
        overflow-x: auto;
    }
`;

const Category = styled(NavLink)`
    font-size: 1.125rem;
    cursor: pointer;
    white-space: pre;
    text-decoration: none;
    color: inherit;
    padding-bottom: 0.25rem;

    &:hover{
        color: #495057;
    }

    &.active{
        font-weight: 600;
        border-bottom: 2px solid #22b8cf;
        color: #22b8cf;
        &:hover{
            color: #ebc9db;
        }
    }



    & + & {
        margin-left: 1rem;
    }
    `;

    const Categories = ({onSelect, category}) => {
        return (
            <CategoriesBlock>
                {categories.map(c=>(
                    <Category
                    key={c.name}
                    activeClassName="active"
                    exact={c.name==='all'}
                    to={c.name==='all'?'/':`/${c.name}`}
                    >
                    {c.text}
                    </Category>
                ))}
            </CategoriesBlock>
        );
    };

export default Categories;
```

- NavLinkë¡œ ë§Œë“¤ì–´ì§„ Category ì»´í¬ë„ŒíŠ¸ì— to ê°’ì€ "/ì¹´í…Œê³ ë¦¬ì´ë¦„"ìœ¼ë¡œ ì„¤ì •
- ì¹´í…Œê³ ë¦¬ ì¤‘ì—ì„œ ì „ì²´ë³´ê¸°ì˜ ê²½ìš° ì˜ˆì™¸ì ìœ¼ë¡œ "/all" ëŒ€ì‹ ì— "/"ìœ¼ë¡œ ì„¤ì •
- to ê°’ì´ "/"ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆì„ ë•ŒëŠ” exact ê°’ì„ true ë¡œ í•´ì£¼ì–´ì•¼í•¨(ì „ì²´ë³´ê¸° ë§í¬ì— active ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒ)

### 14.8 usePromise ì»¤ìŠ¤í…€ Hook ë§Œë“¤ê¸°

â—ì»´í¬ë„ŒíŠ¸ì—ì„œ API í˜¸ì¶œì²˜ëŸ¼ promiseë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° ë”ìš± ê°„ê²°í•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì»¤ìŠ¤í…€ HOOKì„ ë§Œë“¤ì–´ì„œ í”„ë¡œì íŠ¸ì— ì ìš©í•´ë³´ì!

```javascript:lib/Promise.js
import {useState, useEffect} from 'react';

export default function usePromise(promiseCreator, deps){
    //ëŒ€ê¸° ì¤‘/ì™„ë£Œ/ì‹¤íŒ¨ì— ëŒ€í•œ ìƒíƒœ ê´€ë¦¬
    const [loading, setLoading] = useState(false);
    const [resolved, setResolved] = useState(null);
    const [error, setError] = useState(null);

    useEffect(()=>{
        const process = async () => {
            setLoading(true);
            try{
                const resolved = await promiseCreator();
                setResolved(resolved);
            }catch(e){
                setError(e);
            }
            setLoading(false);
        };
        process();
    }, deps);

    return [loading, resolved, error];
}
```

- í”„ë¡œì íŠ¸ì˜ ë‹¤ì–‘í•œ ê³³ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ìœ í‹¸í•¨ìˆ˜ë“¤ì€ src ë””ë ‰í† ë¦¬ì— lib ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“  í›„ ê·¸ ì•ˆì— ì‘ì„±
- ë°©ê¸ˆ ë§Œë“  usePromise Hookì€ promiseì˜ ëŒ€ê¸°ì¤‘, ì™„ë£Œ ê²°ê³¼, ì‹¤íŒ¨ ê²°ê³¼ì— ëŒ€í•œ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ë©°, usePromiseì˜ ì˜ì¡´ ë°°ì—´ depsë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜´
- íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜¨ deps ë°°ì—´ì€ usePromise ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•œ useEffectì˜ ì˜ì¡´ ë°°ì—´ë¡œ ì„¤ì •
- ì´ ë°°ì—´ì„ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì—ì„œ ESLint ê²½ê³ ê°€ ë‚˜íƒ€ë‚¨
- ì´ ê²½ê³ ë¥¼ ë¬´ì‹œí•˜ë ¤ë©´ ESLint ê·œì¹™ì„ ë¬´ì‹œí•˜ë„ë¡ ì£¼ì„ì„ ì‘ì„±í•´ì£¼ì–´ì•¼ í•¨

```javascript:components/NewsList.js
import React, {useState, useEffect} from 'react';
import styled from 'styled-components';
import NewsItem from './NewsItem';
import axios from 'axios';
import usePromise from '../lib/usePromise';

const NewsListBlock = styled.div`
    box-sizing: border-box;
    padding-bottom: 3rem;
    width: 768px;
    margin: 0 auto;
    margin-top: 2rem;
    @media screen and (max-with: 768px){
        width: 100%;
        padding-left: 1rem;
        padding-right: 1rem;

    }
    `;


    const NewsList=({category})=>{
        const [loading, response, error]= usePromise(()=>{
            const query = category === 'all'?'':`&{category}`;
            return axios.get(
                'https://newsapi.org/v2/top-headlines?country=kr&apiKey=c33d47e154f7420dba0b22bc0f01c941'

            );
        },[category]);



        if(loading){
            return <NewsListBlock>ëŒ€ê¸° ì¤‘.....</NewsListBlock>
        }
        if(!response){
            return null;
        }

        if(error){
            return <NewsListBlock>ì—ëŸ¬ ë°œìƒ!</NewsListBlock>
        }
        const {articles}=response.data;
        return(
            <NewsListBlock>
                {articles.map(article =>(
                    <NewsItem key={article.url} article={article}/>
                ))}
            </NewsListBlock>
        );
    };

    export default NewsList;
```

usePromiseë¥¼ ì“°ë©´ NewsListì—ì„œ ëŒ€ê¸° ì¤‘ ìƒíƒœê´€ë¦¬ì™€ useEffect ì„¤ì •ì„ ì§ì ‘ í•˜ì§€ ì•Šì•„ë„ ë˜ë¯€ë¡œ ì½”ë“œê°€ í›¨ì”¬ ê°„ê²°í•´ì§
ìš”ì²­ ìƒíƒœë¥¼ ê´€ë¦¬í•  ë•Œ ë¬´ì¡°ê±´ ì»¤ìŠ¤í…€ Hookì„ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ,
ìƒí™ì— ë”°ë¼ ì ì ˆíˆ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ ì½”ë“œë¥¼ ë§Œë“¤ì–´ê°ˆ ìˆ˜ ìˆìŒ

## 15ì¥(Recoil ëŒ€ì²´)

### ì†Œê°œ - ë™ê¸°

### ì†Œê°œ - ì£¼ìš” ê°œë…

#### Atoms

#### Selectors

### ì†Œê°œ - ì„¤ì¹˜

### ì†Œê°œ - Recoil ì‹œì‘í•˜ê¸°

### ê¸°ë³¸ ììŠµì„œ - ë„ì…ë¶€

### ê¸°ë³¸ ììŠµì„œ - Atoms

### ê¸°ë³¸ ììŠµì„œ - Selectors
